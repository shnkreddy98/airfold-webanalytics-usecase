name: funnel_analysis
nodes:
  - analysis:
      sql: |
        SELECT 
          session_id,
          event,
          RANK() OVER(PARTITION BY session_id ORDER BY timestamp ASC)
        FROM web_events
        WHERE event IS NOT NULL
publish: funnel_analysis
